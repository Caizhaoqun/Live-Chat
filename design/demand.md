# Live-Chat需求分析

### 主页加载
主页加载的时候需要动态加载下面几项

- 加载用户的聊天列表
- 加载用户正在聊天的对象
- 如果用户正在群聊，加载用户最后20条聊天记录
- 如果用户正在私聊，加载当前聊天对象的最后20条聊天记录

### 点击在线用户
点击任意一个在线用户，首先判断用户是在聊天列表中

- 如果在，将聊天对象切换成该用户，并发送ajax请求，更改该用户的正在聊天的对象
- 如果不在，将该用户添加到聊天列表，将聊天对象切换成该用户，并发送Ajax请求，更改数据库中该用户正在聊天的对象，并添加到聊天用户列表。

### 聊天列表
- 登录成功或者刷新页面之后，如果加载好的聊天列表不为空，需要添加到聊天列表中去，这时候需要判断每一个用户是不是离线，如果是离线，需要在聊天窗口上方给出用户离线的提示，并且将用户的头像灰色显示。
- 对于当前聊天对象，需要加背景或者其他css属性来标明
- 点击聊天用户列表中的某一个用户，需要将聊天对象的名字切换成该用户的名字，并发送Ajax请求，更改数据库中该用户正在聊天的对象。
- 键盘切换聊天用户，如果同时点击Ctrl键和Tab键，更改当前聊天对象为下一个聊天对象，将聊天对象的名字改成下一个用户的名字；发送Ajax请求，更改数据库中该用户正在聊天的对象。
- 点击用户右上角的`X`，删除当前聊天对象，将聊天对象切换成下一个聊天对象，如果该用户是最后一个聊天对象，将当前聊天对象切换成群聊；发送Ajax请求，更改数据库中该用户的聊天列表。

### 发送消息
- 按下键盘的任意键，将焦点切换成输入框
- 如果用户点击Enter键